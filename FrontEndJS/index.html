<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard RabbitDemo</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h1 { color: #333; }
        p { font-size: 18px; }
        input { padding: 8px; width: 300px; margin-right: 10px; }
        button { padding: 8px 16px; cursor: pointer; }
        #status { margin-top: 10px; color: green; }
    </style>
</head>
<body>
    <h1>Dashboard RabbitDemo</h1>

    <!-- Se mantienen tus IDs EXACTOS -->
    <p>Mensajes totales en SQLite: <span id="sqlite-count">Cargando...</span></p>
    <p>Mensajes totales en MongoDB: <span id="mongo-count">Cargando...</span></p>

    <input type="text" id="message-input" placeholder="Mensaje de prueba" />
    <button id="send-btn">Enviar a RabbitMQ</button>
    <div id="status"></div>

    <script>
        // ================================
        // CONFIGURACIÓN DE ENDPOINTS
        // ================================
        const apiMessages = "http://localhost:5049/api/messages";
        const countEndpoint = `${apiMessages}/count`;

        // ================================
        // ELEMENTOS HTML
        // ================================
        const sqliteCountEl = document.getElementById("sqlite-count");
        const mongoCountEl = document.getElementById("mongo-count");
        const messageInput = document.getElementById("message-input");
        const sendBtn = document.getElementById("send-btn");
        const statusEl = document.getElementById("status");

        // ================================
        // ACTUALIZAR CONTADORES
        // ================================
        async function updateCounts() {
            try {
                const res = await fetch(countEndpoint);
                if (!res.ok) throw new Error("Error en el servidor");
                
                const data = await res.json();

                // Coinciden EXACTAMENTE con lo que devuelve tu API:
                // {
                //   "sqlite": 0,
                //   "mongoDB": 0
                // }

                sqliteCountEl.textContent = data.sqlite;
                mongoCountEl.textContent = data.mongoDB;

            } catch (err) {
                console.error("Error obteniendo conteos:", err);
                sqliteCountEl.textContent = "Error";
                mongoCountEl.textContent = "Error";
            }
        }

        // ================================
        // ENVIAR MENSAJE
        // ================================
        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) {
                alert("Ingresa un mensaje.");
                return;
            }

            try {
                const res = await fetch(apiMessages, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(message)
                });

                if (res.ok) {
                    messageInput.value = "";
                    statusEl.textContent = "Mensaje enviado con éxito";

                    // Actualiza los contadores
                    updateCounts();

                    setTimeout(() => statusEl.textContent = "", 3000);
                } else {
                    alert("Error enviando mensaje");
                }
            } catch (err) {
                console.error("Error enviando mensaje:", err);
                alert("No se pudo enviar el mensaje.");
            }
        }

        // Eventos de interacción
        sendBtn.addEventListener("click", sendMessage);
        messageInput.addEventListener("keypress", e => {
            if (e.key === "Enter") sendMessage();
        });

        // ================================
        // ACTUALIZAR AL INICIAR + AUTOREFRESH
        // ================================
        updateCounts();
        setInterval(updateCounts, 5000);
    </script>
</body>
</html>




















<!-- <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard RabbitDemo</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h1 { color: #333; }
        p { font-size: 18px; }
        input { padding: 8px; width: 300px; margin-right: 10px; }
        button { padding: 8px 16px; cursor: pointer; }
        #status { margin-top: 10px; color: green; }
    </style>
</head>
<body>
    <h1>Dashboard RabbitDemo</h1>

    <p>Mensajes totales en SQLite: <span id="sqlite-count">Cargando...</span></p>
    <p>Mensajes totales en MongoDB: <span id="mongo-count">Cargando...</span></p>

    <input type="text" id="message-input" placeholder="Mensaje de prueba" />
    <button id="send-btn">Enviar a RabbitMQ</button>
    <div id="status"></div>

    <script>
        const apiMessages = "http://localhost:5000/api/messages";
        const countEndpoint = `${apiMessages}/count`;

        const sqliteCountEl = document.getElementById("sqlite-count");
        const mongoCountEl = document.getElementById("mongo-count");
        const messageInput = document.getElementById("message-input");
        const sendBtn = document.getElementById("send-btn");
        const statusEl = document.getElementById("status");

        async function updateCounts() {
            try {
                const res = await fetch(countEndpoint);
                if (!res.ok) throw new Error("Error en el servidor");
                const data = await res.json();

                sqliteCountEl.textContent = data.Sqlite;
                mongoCountEl.textContent = data.MongoDB;
            } catch (err) {
                console.error("Error obteniendo conteos:", err);
                sqliteCountEl.textContent = "Error";
                mongoCountEl.textContent = "Error";
            }
        }

        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return alert("Ingresa un mensaje.");

            try {
                const res = await fetch(apiMessages, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(message)
                });

                if (res.ok) {
                    messageInput.value = "";
                    statusEl.textContent = "Mensaje enviado con éxito";
                    updateCounts();
                    setTimeout(() => statusEl.textContent = "", 3000);
                } else {
                    alert("Error enviando mensaje");
                }
            } catch (err) {
                console.error("Error enviando mensaje:", err);
            }
        }

        sendBtn.addEventListener("click", sendMessage);
        messageInput.addEventListener("keypress", e => {
            if (e.key === "Enter") sendMessage();
        });

        // Actualizar conteos al cargar y cada 5 segundos
        updateCounts();
        setInterval(updateCounts, 5000);
    </script>
</body>
</html> -->




















<!-- <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard RabbitDemo</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h1 { color: #333; }
        p { font-size: 18px; }
        input { padding: 8px; width: 300px; margin-right: 10px; }
        button { padding: 8px 16px; cursor: pointer; }
        #status { margin-top: 10px; color: green; }
    </style>
</head>
<body>
    <h1>Dashboard RabbitDemo</h1>

    <p>Mensajes totales en SQLite: <span id="sqlite-count">Cargando...</span></p>
    <p>Mensajes totales en MongoDB: <span id="mongo-count">Cargando...</span></p>

    <input type="text" id="message-input" placeholder="Mensaje de prueba" />
    <button id="send-btn">Enviar a RabbitMQ</button>
    <div id="status"></div>

    <script>
        const apiMessages = "http://localhost:5000/api/messages";
        const countEndpoint = `${apiMessages}/count`;

        const sqliteCountEl = document.getElementById("sqlite-count");
        const mongoCountEl = document.getElementById("mongo-count");
        const messageInput = document.getElementById("message-input");
        const sendBtn = document.getElementById("send-btn");
        const statusEl = document.getElementById("status");

        async function updateCounts() {
            try {
                const res = await fetch(countEndpoint);
                if (!res.ok) throw new Error("Error en el servidor");
                const data = await res.json();

                sqliteCountEl.textContent = data.Sqlite;
                mongoCountEl.textContent = data.MongoDB;
            } catch (err) {
                console.error("Error obteniendo conteos:", err);
                sqliteCountEl.textContent = "Error";
                mongoCountEl.textContent = "Error";
            }
        }

        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return alert("Ingresa un mensaje.");

            try {
                const res = await fetch(apiMessages, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(message)
                });

                if (res.ok) {
                    messageInput.value = "";
                    statusEl.textContent = "Mensaje enviado con éxito";
                    updateCounts();
                    setTimeout(() => statusEl.textContent = "", 3000);
                } else {
                    alert("Error enviando mensaje");
                }
            } catch (err) {
                console.error("Error enviando mensaje:", err);
            }
        }

        sendBtn.addEventListener("click", sendMessage);
        messageInput.addEventListener("keypress", e => {
            if (e.key === "Enter") sendMessage();
        });

        // Actualizar conteos al cargar y cada 5 segundos
        updateCounts();
        setInterval(updateCounts, 5000);
    </script>
</body>
</html> -->



















<!-- <h1>Dashboard RabbitDemo</h1>

<p>Mensajes totales en SQLite: <span id="sqlite-count">Cargando...</span></p>
<p>Mensajes totales en MongoDB: <span id="mongo-count">Cargando...</span></p>

<input type="text" id="message-input" placeholder="Mensaje de prueba" />
<button id="send-btn">Enviar a RabbitMQ</button>

<script src="app.js"></script> -->



















<!-- <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>RabbitDemo Dashboard</title>
</head>
<body>
    <h1>Dashboard RabbitDemo</h1>
    <div>
        <p>Mensajes totales en SQLite: <span id="sqlite-count">Cargando...</span></p>
        <p>Mensajes totales en MongoDB: <span id="mongo-count">Cargando...</span></p>
    </div>
    <div>
        <input type="text" id="message-input" placeholder="Mensaje de prueba">
        <button id="send-btn">Enviar a RabbitMQ</button>
    </div>
    <script src="app.js"></script>
</body>
</html> -->